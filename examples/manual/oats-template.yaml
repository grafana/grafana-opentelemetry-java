matrix:
  - name: new
    docker-compose:
      generator: java
  - name: old-jvm-metrics
    docker-compose:
      generator: java
      java-generator-params:
        old-jvm-metrics: true
        disable-data-saver: true
  - name: prom-naming
    docker-compose:
      generator: java
      java-generator-params:
        disable-data-saver: true
        prom-naming: true
  - name: prom-naming-old-jvm-metrics
    docker-compose:
      generator: java
      java-generator-params:
        disable-data-saver: true
        old-jvm-metrics: true
        prom-naming: true
input:
  - path: /stock
expected:
  traces:
    - traceql: '{ name = "get_cart" }' # created by @WithSpan
      spans:
        - name: 'get_cart'
  metrics:
    - promql: 'cart_client{}' # created programmatically
      value: '>= 0'
  dashboards:
    - path: ../jvm-dashboard.json
      panels:
        - title: CPU utilization
          value: ">= 0"
        - title: Heap Memory Utilization
          value: "> 0"
        - title: Garbage Collection
          value: ">= 0"
        - title: Classes
          value: "> 0"
        - title: Threads
          value: "> 0"
